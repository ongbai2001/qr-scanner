// Fallback functions for local storage
        function loadOrders() {
            // Kh·ªüi t·∫°o v·ªõi d·ªØ li·ªáu m·∫´u ƒë·ªÉ demo
            orders = [];
            updateStats();
            displayOrders();
        }<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu√©t Barcode ƒê∆°n H√†ng</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 40px;
        }

        .tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #eee;
        }

        .tab {
            padding: 15px 30px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1.1rem;
            font-weight: 600;
            color: #666;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab:hover {
            color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .scanner-section {
            text-align: center;
            margin-bottom: 30px;
        }

        #scanner {
            width: 100%;
            max-width: 500px;
            height: 300px;
            border: 3px solid #667eea;
            border-radius: 15px;
            margin: 20px auto;
            overflow: hidden;
            position: relative;
        }

        #scanner video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .scanner-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 100px;
            border: 2px solid #ff4757;
            border-radius: 10px;
            pointer-events: none;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .order-form {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .stat-card h3 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .stat-card p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .orders-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .orders-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .orders-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }

        .orders-table tr:hover {
            background: rgba(102, 126, 234, 0.05);
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-shipped {
            background: #d4edda;
            color: #155724;
        }

        .status-delivered {
            background: #cce7ff;
            color: #004085;
        }

        .result-message {
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            font-weight: 600;
        }

        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .delete-btn:hover {
            background: #c82333;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                padding: 10px 20px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .orders-table {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üì¶ Qu√©t Barcode ƒê∆°n H√†ng</h1>
            <p>Qu·∫£n l√Ω v√† th·ªëng k√™ ƒë∆°n h√†ng th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠</p>
        </div>
        
        <div class="main-content">
            <div class="tabs">
                <button class="tab active" onclick="showTab('scanner')">üì± Qu√©t Barcode</button>
                <button class="tab" onclick="showTab('orders')">üìã Danh S√°ch ƒê∆°n H√†ng</button>
                <button class="tab" onclick="showTab('stats')">üìä Th·ªëng K√™</button>
            </div>

            <!-- Tab Qu√©t Barcode -->
            <div id="scanner-tab" class="tab-content active">
                <div class="scanner-section">
                    <h2 style="margin-bottom: 20px; color: #333;">Qu√©t Barcode ƒê∆°n H√†ng</h2>
                    <div id="scanner">
                        <div class="scanner-overlay"></div>
                    </div>
                    <button id="start-scan" class="btn">üé• B·∫Øt ƒê·∫ßu Qu√©t</button>
                    <button id="stop-scan" class="btn" style="display: none;">‚èπÔ∏è D·ª´ng Qu√©t</button>
                </div>

                <div class="order-form">
                    <h3 style="margin-bottom: 20px; color: #333;">Th√¥ng Tin ƒê∆°n H√†ng</h3>
                    <div class="form-group">
                        <label for="barcode">M√£ Barcode:</label>
                        <input type="text" id="barcode" placeholder="Qu√©t ho·∫∑c nh·∫≠p m√£ barcode">
                    </div>
                    <div class="form-group">
                        <label for="customer-name">T√™n Kh√°ch H√†ng:</label>
                        <input type="text" id="customer-name" placeholder="Nh·∫≠p t√™n kh√°ch h√†ng">
                    </div>
                    <div class="form-group">
                        <label for="product-name">T√™n S·∫£n Ph·∫©m:</label>
                        <input type="text" id="product-name" placeholder="Nh·∫≠p t√™n s·∫£n ph·∫©m">
                    </div>
                    <div class="form-group">
                        <label for="platform">S√†n TMƒêT:</label>
                        <select id="platform">
                            <option value="">Ch·ªçn s√†n th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠</option>
                            <option value="Shopee">Shopee</option>
                            <option value="Lazada">Lazada</option>
                            <option value="Tiki">Tiki</option>
                            <option value="Sendo">Sendo</option>
                            <option value="TikTok Shop">TikTok Shop</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="status">Tr·∫°ng Th√°i:</label>
                        <select id="status">
                            <option value="pending">Ch·ªù X·ª≠ L√Ω</option>
                            <option value="shipped">ƒê√£ G·ª≠i</option>
                            <option value="delivered">ƒê√£ Giao</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="notes">Ghi Ch√∫:</label>
                        <textarea id="notes" rows="3" placeholder="Ghi ch√∫ th√™m (kh√¥ng b·∫Øt bu·ªôc)"></textarea>
                    </div>
                    <button class="btn" onclick="saveOrder()">üíæ L∆∞u ƒê∆°n H√†ng</button>
                    <button class="btn" onclick="initializeFirebase()" style="background: #28a745;">üîÑ K·∫øt N·ªëi L·∫°i Firebase</button>
                </div>

                <div id="result-message"></div>
            </div>

            <!-- Tab Danh S√°ch ƒê∆°n H√†ng -->
            <div id="orders-tab" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="color: #333;">Danh S√°ch ƒê∆°n H√†ng</h2>
                    <button class="btn" onclick="clearAllOrders()">üóëÔ∏è X√≥a T·∫•t C·∫£</button>
                </div>
                <div id="orders-list">
                    <p style="text-align: center; color: #666; padding: 40px;">Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o ƒë∆∞·ª£c qu√©t</p>
                </div>
            </div>

            <!-- Tab Th·ªëng K√™ -->
            <div id="stats-tab" class="tab-content">
                <h2 style="margin-bottom: 30px; color: #333;">Th·ªëng K√™ ƒê∆°n H√†ng</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="total-orders">0</h3>
                        <p>T·ªïng ƒê∆°n H√†ng</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="today-orders">0</h3>
                        <p>ƒê∆°n H√†ng H√¥m Nay</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="pending-orders">0</h3>
                        <p>Ch·ªù X·ª≠ L√Ω</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="shipped-orders">0</h3>
                        <p>ƒê√£ G·ª≠i</p>
                    </div>
                </div>
                
                <div style="background: #f8f9fa; padding: 30px; border-radius: 15px;">
                    <h3 style="margin-bottom: 20px; color: #333;">Th·ªëng K√™ Theo S√†n TMƒêT</h3>
                    <div id="platform-stats"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // D·ªØ li·ªáu ƒë∆°n h√†ng v√† Firebase references
        let orders = [];
        let isScanning = false;
        let db = null;
        let firebaseModules = null;
        let firebaseInitialized = false;

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD-MjMnmrCuZhEwacmeXXiTppMB42p9Epg",
            authDomain: "phu117.firebaseapp.com",
            projectId: "phu117",
            storageBucket: "phu117.firebasestorage.app",
            messagingSenderId: "612585313910",
            appId: "1:612585313910:web:ae5815ac048f861a4eb157",
            measurementId: "G-MGZF20231H"
        };

        // Initialize Firebase
        async function initializeFirebase() {
            try {
                console.log('ƒêang kh·ªüi t·∫°o Firebase...');
                
                // Import Firebase modules dynamically
                const { initializeApp } = await import("https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js");
                const { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, query, orderBy, onSnapshot } = await import("https://www.gstatic.com/firebasejs/11.8.1/firebase-firestore.js");
                
                // Initialize Firebase app
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                
                firebaseModules = {
                    collection,
                    addDoc,
                    getDocs,
                    deleteDoc,
                    doc,
                    query,
                    orderBy,
                    onSnapshot
                };
                
                firebaseInitialized = true;
                console.log('Firebase ƒë√£ ƒë∆∞·ª£c kh·ªüi t·∫°o th√†nh c√¥ng!');
                showMessage('‚úÖ ƒê√£ k·∫øt n·ªëi Firebase th√†nh c√¥ng!', 'success');
                
                // Load orders from Firebase
                await loadOrdersFromFirebase();
                setupRealtimeListener();
                
            } catch (error) {
                console.error('L·ªói kh·ªüi t·∫°o Firebase:', error);
                showMessage('‚ö†Ô∏è Kh√¥ng th·ªÉ k·∫øt n·ªëi Firebase, s·ª≠ d·ª•ng ch·∫ø ƒë·ªô offline', 'error');
                firebaseInitialized = false;
                loadOrders();
            }
        }

        // Kh·ªüi t·∫°o ·ª©ng d·ª•ng
        document.addEventListener('DOMContentLoaded', function() {
            showMessage('üöÄ ƒêang kh·ªüi ƒë·ªông ·ª©ng d·ª•ng...', 'success');
            initializeFirebase();
        });

        // Chuy·ªÉn ƒë·ªïi tab
        function showTab(tabName) {
            // ·∫®n t·∫•t c·∫£ tab content
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // X√≥a active class t·ª´ t·∫•t c·∫£ tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Hi·ªÉn th·ªã tab ƒë∆∞·ª£c ch·ªçn
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
            
            // C·∫≠p nh·∫≠t stats khi chuy·ªÉn sang tab th·ªëng k√™
            if (tabName === 'stats') {
                updateStats();
            }
        }

        // Kh·ªüi ƒë·ªông qu√©t barcode
        document.getElementById('start-scan').addEventListener('click', function() {
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                startScanner();
            } else {
                showMessage('Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ camera', 'error');
            }
        });

        // D·ª´ng qu√©t barcode
        document.getElementById('stop-scan').addEventListener('click', function() {
            stopScanner();
        });

        // Kh·ªüi ƒë·ªông scanner
        function startScanner() {
            if (isScanning) return;
            
            isScanning = true;
            document.getElementById('start-scan').style.display = 'none';
            document.getElementById('stop-scan').style.display = 'inline-block';

            Quagga.init({
                inputStream: {
                    name: "Live",
                    type: "LiveStream",
                    target: document.querySelector('#scanner'),
                    constraints: {
                        width: 500,
                        height: 300,
                        facingMode: "environment"
                    }
                },
                locator: {
                    patchSize: "medium",
                    halfSample: true
                },
                numOfWorkers: 2,
                decoder: {
                    readers: ["code_128_reader", "ean_reader", "ean_8_reader", "code_39_reader"]
                },
                locate: true
            }, function(err) {
                if (err) {
                    console.log(err);
                    showMessage('Kh√¥ng th·ªÉ kh·ªüi ƒë·ªông camera: ' + err.message, 'error');
                    stopScanner();
                    return;
                }
                Quagga.start();
            });

            Quagga.onDetected(function(data) {
                const code = data.codeResult.code;
                document.getElementById('barcode').value = code;
                showMessage('ƒê√£ qu√©t th√†nh c√¥ng: ' + code, 'success');
                stopScanner();
            });
        }

        // D·ª´ng scanner
        function stopScanner() {
            if (!isScanning) return;
            
            isScanning = false;
            document.getElementById('start-scan').style.display = 'inline-block';
            document.getElementById('stop-scan').style.display = 'none';
            
            if (typeof Quagga !== 'undefined') {
                Quagga.stop();
            }
        }

        // L∆∞u ƒë∆°n h√†ng
        async function saveOrder() {
            const barcode = document.getElementById('barcode').value.trim();
            const customerName = document.getElementById('customer-name').value.trim();
            const productName = document.getElementById('product-name').value.trim();
            const platform = document.getElementById('platform').value;
            const status = document.getElementById('status').value;
            const notes = document.getElementById('notes').value.trim();

            if (!barcode || !customerName || !productName || !platform) {
                showMessage('‚ö†Ô∏è Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc', 'error');
                return;
            }

            const orderData = {
                barcode: barcode,
                customerName: customerName,
                productName: productName,
                platform: platform,
                status: status,
                notes: notes,
                createdAt: new Date().toISOString()
            };

            try {
                if (firebaseInitialized && db && firebaseModules) {
                    // Save to Firebase
                    showMessage('üíæ ƒêang l∆∞u v√†o Firebase...', 'success');
                    await saveOrderToFirebase(orderData);
                } else {
                    // Fallback to local array
                    const order = {
                        id: Date.now().toString(),
                        ...orderData
                    };
                    orders.push(order);
                    displayOrders();
                    updateStats();
                    showMessage('‚úÖ ƒê√£ l∆∞u ƒë∆°n h√†ng (ch·∫ø ƒë·ªô offline)!', 'success');
                }
                
                clearForm();
            } catch (error) {
                console.error('Error saving order:', error);
                // Fallback to local storage
                const order = {
                    id: Date.now().toString(),
                    ...orderData
                };
                orders.push(order);
                displayOrders();
                updateStats();
                showMessage('‚úÖ ƒê√£ l∆∞u ƒë∆°n h√†ng (fallback)!', 'success');
                clearForm();
            }
        }

        // X√≥a form
        function clearForm() {
            document.getElementById('barcode').value = '';
            document.getElementById('customer-name').value = '';
            document.getElementById('product-name').value = '';
            document.getElementById('platform').value = '';
            document.getElementById('status').value = 'pending';
            document.getElementById('notes').value = '';
        }

        // Hi·ªÉn th·ªã th√¥ng b√°o
        function showMessage(message, type) {
            const messageDiv = document.getElementById('result-message');
            messageDiv.innerHTML = `<div class="result-message ${type}">${message}</div>`;
            setTimeout(() => {
                messageDiv.innerHTML = '';
            }, 3000);
        }

        // Load orders from Firebase
        async function loadOrdersFromFirebase() {
            if (!firebaseInitialized || !db || !firebaseModules) {
                console.log('Firebase ch∆∞a s·∫µn s√†ng, s·ª≠ d·ª•ng d·ªØ li·ªáu local');
                loadOrders();
                return;
            }

            try {
                showMessage('üì• ƒêang t·∫£i d·ªØ li·ªáu t·ª´ Firebase...', 'success');
                const { collection, getDocs, query, orderBy } = firebaseModules;
                const q = query(collection(db, 'orders'), orderBy('createdAt', 'desc'));
                const querySnapshot = await getDocs(q);
                
                orders = [];
                querySnapshot.forEach((doc) => {
                    orders.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                displayOrders();
                updateStats();
                showMessage(`‚úÖ ƒê√£ t·∫£i ${orders.length} ƒë∆°n h√†ng t·ª´ Firebase!`, 'success');
            } catch (error) {
                console.error('Error loading orders:', error);
                showMessage('‚ùå L·ªói khi t·∫£i d·ªØ li·ªáu: ' + error.message, 'error');
                // Fallback to local storage
                loadOrders();
            }
        }

        // Setup real-time listener for orders
        function setupRealtimeListener() {
            if (!firebaseInitialized || !db || !firebaseModules) {
                console.log('Firebase ch∆∞a s·∫µn s√†ng cho real-time listener');
                return;
            }

            try {
                const { collection, query, orderBy, onSnapshot } = firebaseModules;
                const q = query(collection(db, 'orders'), orderBy('createdAt', 'desc'));
                
                onSnapshot(q, (querySnapshot) => {
                    orders = [];
                    querySnapshot.forEach((doc) => {
                        orders.push({
                            id: doc.id,
                            ...doc.data()
                        });
                    });
                    displayOrders();
                    updateStats();
                    console.log('üì° D·ªØ li·ªáu ƒë∆∞·ª£c c·∫≠p nh·∫≠t real-time t·ª´ Firebase');
                }, (error) => {
                    console.error('Real-time listener error:', error);
                });
            } catch (error) {
                console.error('Error setting up listener:', error);
            }
        }

        // Save order to Firebase
        async function saveOrderToFirebase(orderData) {
            if (!firebaseInitialized || !db || !firebaseModules) {
                throw new Error('Firebase ch∆∞a ƒë∆∞·ª£c kh·ªüi t·∫°o');
            }

            try {
                const { collection, addDoc } = firebaseModules;
                const docRef = await addDoc(collection(db, 'orders'), orderData);
                showMessage('‚úÖ ƒê√£ l∆∞u ƒë∆°n h√†ng th√†nh c√¥ng v√†o Firebase!', 'success');
                return docRef.id;
            } catch (error) {
                console.error('Error saving order:', error);
                showMessage('‚ùå L·ªói khi l∆∞u ƒë∆°n h√†ng: ' + error.message, 'error');
                throw error;
            }
        }

        // Delete order from Firebase
        async function deleteOrderFromFirebase(orderId) {
            if (!firebaseInitialized || !db || !firebaseModules) {
                throw new Error('Firebase ch∆∞a ƒë∆∞·ª£c kh·ªüi t·∫°o');
            }

            try {
                const { doc, deleteDoc } = firebaseModules;
                await deleteDoc(doc(db, 'orders', orderId));
                showMessage('‚úÖ ƒê√£ x√≥a ƒë∆°n h√†ng kh·ªèi Firebase!', 'success');
            } catch (error) {
                console.error('Error deleting order:', error);
                showMessage('‚ùå L·ªói khi x√≥a ƒë∆°n h√†ng: ' + error.message, 'error');
                throw error;
            }
        }

        // Hi·ªÉn th·ªã danh s√°ch ƒë∆°n h√†ng
        function displayOrders() {
            const ordersList = document.getElementById('orders-list');
            
            if (orders.length === 0) {
                ordersList.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o ƒë∆∞·ª£c qu√©t</p>';
                return;
            }

            let html = `
                <table class="orders-table">
                    <thead>
                        <tr>
                            <th>M√£ Barcode</th>
                            <th>Kh√°ch H√†ng</th>
                            <th>S·∫£n Ph·∫©m</th>
                            <th>S√†n TMƒêT</th>
                            <th>Tr·∫°ng Th√°i</th>
                            <th>Ng√†y T·∫°o</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            orders.forEach(order => {
                const date = new Date(order.createdAt);
                const formattedDate = date.toLocaleDateString('vi-VN') + ' ' + date.toLocaleTimeString('vi-VN');
                
                let statusClass = 'status-pending';
                let statusText = 'Ch·ªù X·ª≠ L√Ω';
                
                if (order.status === 'shipped') {
                    statusClass = 'status-shipped';
                    statusText = 'ƒê√£ G·ª≠i';
                } else if (order.status === 'delivered') {
                    statusClass = 'status-delivered';
                    statusText = 'ƒê√£ Giao';
                }

                html += `
                    <tr>
                        <td><strong>${order.barcode}</strong></td>
                        <td>${order.customerName}</td>
                        <td>${order.productName}</td>
                        <td>${order.platform}</td>
                        <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                        <td>${formattedDate}</td>
                        <td><button class="delete-btn" onclick="deleteOrder(${order.id})">X√≥a</button></td>
                    </tr>
                `;
            });

            html += '</tbody></table>';
            ordersList.innerHTML = html;
        }

        // X√≥a ƒë∆°n h√†ng
        async function deleteOrder(orderId) {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a ƒë∆°n h√†ng n√†y?')) {
                try {
                    if (firebaseInitialized && db && firebaseModules) {
                        await deleteOrderFromFirebase(orderId);
                    } else {
                        // Fallback to local array
                        orders = orders.filter(order => order.id !== orderId);
                        displayOrders();
                        updateStats();
                        showMessage('‚úÖ ƒê√£ x√≥a ƒë∆°n h√†ng th√†nh c√¥ng!', 'success');
                    }
                } catch (error) {
                    console.error('Error deleting order:', error);
                    // Fallback to local deletion
                    orders = orders.filter(order => order.id !== orderId);
                    displayOrders();
                    updateStats();
                    showMessage('‚úÖ ƒê√£ x√≥a ƒë∆°n h√†ng (fallback)!', 'success');
                }
            }
        }

        // X√≥a t·∫•t c·∫£ ƒë∆°n h√†ng
        async function clearAllOrders() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t·∫•t c·∫£ ƒë∆°n h√†ng?')) {
                try {
                    if (firebaseInitialized && db && firebaseModules) {
                        // Delete all orders from Firebase
                        showMessage('üóëÔ∏è ƒêang x√≥a t·∫•t c·∫£ ƒë∆°n h√†ng...', 'success');
                        const deletePromises = orders.map(order => deleteOrderFromFirebase(order.id));
                        await Promise.all(deletePromises);
                        showMessage('‚úÖ ƒê√£ x√≥a t·∫•t c·∫£ ƒë∆°n h√†ng kh·ªèi Firebase!', 'success');
                    } else {
                        // Fallback to local array
                        orders = [];
                        displayOrders();
                        updateStats();
                        showMessage('‚úÖ ƒê√£ x√≥a t·∫•t c·∫£ ƒë∆°n h√†ng!', 'success');
                    }
                } catch (error) {
                    console.error('Error clearing orders:', error);
                    orders = [];
                    displayOrders();
                    updateStats();
                    showMessage('‚úÖ ƒê√£ x√≥a t·∫•t c·∫£ ƒë∆°n h√†ng (fallback)!', 'success');
                }
            }
        }

        // C·∫≠p nh·∫≠t th·ªëng k√™
        function updateStats() {
            const today = new Date().toDateString();
            const todayOrders = orders.filter(order => new Date(order.createdAt).toDateString() === today);
            const pendingOrders = orders.filter(order => order.status === 'pending');
            const shippedOrders = orders.filter(order => order.status === 'shipped');

            document.getElementById('total-orders').textContent = orders.length;
            document.getElementById('today-orders').textContent = todayOrders.length;
            document.getElementById('pending-orders').textContent = pendingOrders.length;
            document.getElementById('shipped-orders').textContent = shippedOrders.length;

            // Th·ªëng k√™ theo s√†n TMƒêT
            const platformStats = {};
            orders.forEach(order => {
                if (platformStats[order.platform]) {
                    platformStats[order.platform]++;
                } else {
                    platformStats[order.platform] = 1;
                }
            });

            let platformHtml = '';
            for (const [platform, count] of Object.entries(platformStats)) {
                platformHtml += `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #eee;">
                        <span style="font-weight: 600;">${platform}</span>
                        <span style="background: #667eea; color: white; padding: 5px 15px; border-radius: 20px;">${count} ƒë∆°n</span>
                    </div>
                `;
            }

            if (platformHtml === '') {
                platformHtml = '<p style="text-align: center; color: #666;">Ch∆∞a c√≥ d·ªØ li·ªáu th·ªëng k√™</p>';
            }

            document.getElementById('platform-stats').innerHTML = platformHtml;
        }
    </script>
</body>
</html>
